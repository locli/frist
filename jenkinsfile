pipline {
	enviroment {
		devOpenshiftUrl		=	"api.ocp4.home.igotit.co.kr:6443"
		devOpenshiftUser	=	"jslee"
		devNameSpace		=	"kb"

		devRegistry			=	"default-route-openshift-image-registry.apps.ocp4.home.igotit.co.kr"
		devTag				=	"latest"
		devApplication		=	"rca2-motp"
	}
  
  agent { label 'master' }
  
  stages {
      stage('OpenshiftLogin'){
          steps {
             script{
                 echo "Openshift Token 설정"
					       beforeTm1 = sh(script: "date +%s", returnStdout: true).trim() as Integer
                 
                 withCredentials([usernamePassword(credentialsId: devOpenshiftUser, usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD')]){
							       sh "oc login https://"+ devOpenshiftUrl +" -u $USERNAME -p $PASSWORD --insecure-skip-tls-verify=true" 
						     }
                 devOpenshiftToken = sh(script: "oc whami -t", returnStdout: true).trim()
        				 beforeTm2 = sh(script: "date +%s", returnStdout: true).trim() as Integer
             }
          }
      }
      


}
